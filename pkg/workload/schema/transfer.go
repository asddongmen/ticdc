// Copyright 2022 PingCAP, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// See the License for the specific language governing permissions and
// limitations under the License.

package schema

import (
	"bytes"
	"fmt"
	"math/rand"
)

// This table's row size is 1818 bytes.
const createExpressTable = `
CREATE TABLE if not exists cdc_test_express%d (
    id bigint(20) NOT NULL COMMENT 'ID',
    c1 tinyint(2) NOT NULL DEFAULT '1' COMMENT '1:2:',
    c2 varchar(32) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
    c3 int(11) NOT NULL DEFAULT '0' COMMENT 'id',
    c4 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c5 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c6 int(11) NOT NULL DEFAULT '0' COMMENT 'id',
    c7 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c8 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c9 int(11) DEFAULT NULL,
    c10 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c11 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c12 int(11) DEFAULT NULL COMMENT 'id',
    c13 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c14 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c15 int(11) DEFAULT NULL,
    c16 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c17 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c18 int(11) DEFAULT NULL COMMENT 'id',
    c19 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c20 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c21 varchar(30) COLLATE utf8mb4_general_ci NOT NULL,
    c22 timestamp NULL DEFAULT NULL,
    c23 int(11) DEFAULT NULL COMMENT 'id',
    c24 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c25 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c26 int(11) DEFAULT NULL COMMENT 'id',
    c27 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c28 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c29 int(11) DEFAULT NULL COMMENT 'id',
    c30 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c31 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c32 int(11) DEFAULT NULL COMMENT 'id',
    c33 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c34 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c35 int(11) DEFAULT NULL COMMENT 'id',
    c36 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c37 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c38 int(11) DEFAULT NULL COMMENT 'id',
    c39 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c40 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c41 timestamp NULL DEFAULT NULL,
    c42 int(11) DEFAULT NULL COMMENT 'id',
    c43 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c44 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c45 int(11) DEFAULT NULL COMMENT 'id',
    c46 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c47 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c48 timestamp NULL DEFAULT NULL,
    c49 int(11) DEFAULT NULL COMMENT 'ID',
    c50 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c51 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c52 int(11) DEFAULT NULL COMMENT 'ID',
    c53 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c54 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c55 int(11) DEFAULT '0' COMMENT 'ID',
    c56 varchar(50) COLLATE utf8mb4_general_ci DEFAULT '',
    c57 timestamp NULL DEFAULT NULL,
    c58 date NOT NULL,
    c59 timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    c60 int(11) DEFAULT '1',
    c61 int(11) DEFAULT NULL,
    c62 decimal(12, 2) DEFAULT '0.00',
    c63 int(11) NOT NULL COMMENT 'ID',
    c64 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c65 varchar(30) COLLATE utf8mb4_general_ci NOT NULL,
    c66 decimal(12, 2) DEFAULT '0.00',
    c67 decimal(12, 2) DEFAULT '0.00',
    c68 decimal(12, 2) DEFAULT '0.00',
    c69 tinyint(2) DEFAULT '2' COMMENT '12',
    c70 tinyint(2) DEFAULT '2' COMMENT '12',
    c71 tinyint(2) DEFAULT '2' COMMENT '12',
    c72 varchar(60) COLLATE utf8mb4_general_ci NOT NULL COMMENT '=++(',
    c73 int(11) DEFAULT NULL COMMENT 'id',
    c74 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c75 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c76 int(11) DEFAULT NULL COMMENT 'ID',
    c77 varchar(50) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c78 timestamp NULL DEFAULT NULL,
    c79 tinyint(2) DEFAULT '2' COMMENT '12',
    c80 int(11) DEFAULT '0' COMMENT 'ID',
    c81 varchar(50) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c82 timestamp NULL DEFAULT NULL,
    c83 tinyint(2) DEFAULT '2' COMMENT '12',
    c84 timestamp NULL DEFAULT NULL,
    c85 tinyint(2) DEFAULT '2' COMMENT '12',
    c86 tinyint(2) DEFAULT '2' COMMENT ' 1 2',
    c87 tinyint(2) DEFAULT '2' COMMENT ' 1 2 ',
    c88 tinyint(2) DEFAULT '2' COMMENT '12',
    c89 timestamp NULL DEFAULT NULL,
    c90 tinyint(2) DEFAULT '2' COMMENT '12',
    c91 tinyint(2) DEFAULT '1' COMMENT '12',
    c92 varchar(50) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
    c93 tinyint(2) NOT NULL DEFAULT '1',
    c94 tinyint(2) NOT NULL DEFAULT '1',
    c95 int(11) NOT NULL DEFAULT '0' COMMENT 'ID',
    c96 int(11) NOT NULL DEFAULT '0' COMMENT 'ID',
    c97 varchar(50) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
    c98 varchar(50) COLLATE utf8mb4_general_ci NOT NULL DEFAULT '',
    c99 timestamp DEFAULT CURRENT_TIMESTAMP,
    c100 timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    c101 int(11) NOT NULL DEFAULT '0',
    c102 tinyint(2) NOT NULL DEFAULT '0',
    c103 varchar(50) COLLATE utf8mb4_general_ci DEFAULT '' COMMENT 'traceid',
    c104 int(11) DEFAULT NULL COMMENT 'id',
    c105 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c106 int(11) DEFAULT NULL COMMENT 'id',
    c107 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c108 timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'ES',
    c109 decimal(12, 2) DEFAULT NULL,
    c110 varchar(30) COLLATE utf8mb4_general_ci DEFAULT NULL COMMENT 'CODE',
    c111 int(11) DEFAULT NULL COMMENT 'ID',
    c112 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c113 int(11) NOT NULL DEFAULT '0' COMMENT 'ID',
    c114 varchar(255) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c115 varchar(60) COLLATE utf8mb4_general_ci DEFAULT NULL,
    c116 tinyint(2) DEFAULT '2' COMMENT ' 1: 2:',
    c117 int(11) DEFAULT NULL COMMENT '1 2 3 4 ',
    c118 decimal(12, 2) DEFAULT NULL,
    c119 int(11) DEFAULT NULL COMMENT '2021022409',
    c120 decimal(12, 2) DEFAULT '0.00' COMMENT ',',
    c121 decimal(12, 2) DEFAULT '0.00' COMMENT ',',
    c122 decimal(12, 2) DEFAULT '0.00' COMMENT ',',
    c123 int(11) DEFAULT NULL,
    c124 varchar(30) COLLATE utf8mb4_general_ci DEFAULT '',
    c125 varchar(60) COLLATE utf8mb4_general_ci DEFAULT '' COMMENT 'Name',
    PRIMARY KEY (id) /*T![clustered_index] CLUSTERED */
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_general_ci
`

// GetExpressCreateTableStatement returns the create-table sql of the table n
func GetExpressCreateTableStatement(n int) string {
	return fmt.Sprintf(createExpressTable, n)
}

func BuildExpressReplaceSql(tableN int, rowCount int) string {
	n := rand.Int63()
	var buf bytes.Buffer
	buf.WriteString(
		fmt.Sprintf(`
REPLACE into cdc_test_express%d(
    id,
    c1,
    c2,
    c3,
    c4,
    c5,
    c6,
    c7,
    c8,
    c9,
    c10,
	c11,
    c12,
    c13,
    c14,
    c15,
    c16,
    c17,
    c18,
    c19,
    c20,
    c21,
    c22,
    c23,
    c24,
    c25,
    c26,
    c27,
    c28,
    c29,
    c30,
    c31,
    c32,
    c33,
    c34,
    c35,
    c36,
    c37,
    c38,
    c39,
    c40,
    c41,
    c42,
    c43,
    c44,
    c45,
    c46,
    c47,
    c48,
    c49,
    c50,
    c51,
    c52,
    c53,
    c54,
    c55,
    c56,
    c57,
    c58,
    c59,
    c60,
    c61,
    c62,
    c63,
    c64,
    c65,
    c66,
    c67,
    c68,
    c69,
    c70,
    c71,
    c72,
    c73,
    c74,
    c75,
    c76,
    c77,
    c78,
    c79,
    c80,
    c81,
    c82,
    c83,
    c84,
    c85,
    c86,
    c87,
    c88,
    c89,
    c90,
    c91,
    c92,
    c93,
    c94,
    c95,
    c96,
    c97,
    c98,
    c99,
    c100,
    c101,
    c102,
    c103,
    c104,
    c105,
    c106,
    c107,
    c108,
    c109,
    c110,
    c111,
    c112,
    c113,
    c114,
    c115,
    c116,
    c117,
    c118,
    c119,
    c120,
    c121,
    c122,
    c123,
    c124,
    c125
)
values (
        %d,
        1,
        'collect_no_abcdefghijk1234567890',
        12345678,
        'collect_no_abcdefghijk12345',
        'operation_network_name_12345678901234567890',
        12345678,
        'operation_financial_center_name_1234567890',
        'operation_financial_center_cd',
        12345678,
        'send_financial_center_name_1234567890',
        'send_financial_center_code',
        12345678,
        'send_network_code_12',
        'send_network_name_1234567890',
        12345678,
        '办事处名称12345677',
        'dec_network_name10000',
        12345678,
        'start_financial_center_code',
        'start_financial_center_name',
        'waybill_no%d',
        '2019-03-05 01:53:56',
        12345678,
        'sm_mode_name_12345678901234567890',
        'sm_mode_code_134567890',
        12345678,
        '货品名a货品g货品名a货品g货品名a货品g',
        'product_type_code12345',
        12345678,
        '动次打次xxxxabcdefefe',
        'transport_type_code',
        12345678,
        '商品名商品名商品名商品名',
        'xxxxxxwewf12345',
        12345678,
        'last_financial_center_name',
        'last_financial_center_code',
        12345678,
        'last_network_code',
        'last_network_name',
        '2019-03-05 01:53:56',
        12345678,
        'next_financial_center_name',
        'next_financial_center_code',
        12345678,
        'next_network_code',
        'next_network_name',
        '2019-03-05 01:53:56',
        12345678,
        'begin_name',
        'begin_code',
        12345678,
        'destination_name',
        'destination_code',
        12345678,
        'bill_update_by_name',
        '2019-03-05 01:53:56',
        '2019-03-05 01:53:56',
        '2019-03-05 01:53:56',
        1,
        123456,
        1.34,
        12345678,
        'fee_type_name',
        'fee_type_code',
        45.45,
        22.22,
        34.56,
        1,
        1,
        1,
        '1234567890123456',
        12345678,
        'confirmeder_network_code',
        'confirmeder_network_name',
        12345678,
        'confirmeder_name',
        '2019-03-05 01:53:56',
        2,
        12345678,
        'verifier_name12345678',
        '2019-03-05 01:53:56',
        1,
        '2019-03-05 01:53:56',
        1,
        1,
        1,
        1,
        '2019-03-05 01:53:56',
        2,
        1,
        'remarks1234567890',
        2,
        2,
        12345678,
        12345678,
        'create_by_name创建者',
        'update_by_name更新者',
        '2019-03-05 01:53:56',
        '2019-03-05 01:53:56',
        123,
        0,
        '1234567890',
        12345678,
        '办事处名称',
        12345678,
        '办事处名称',
        '2019-03-05 01:53:56',
        34.56,
        'customer_codeaaaaa',
        12345678,
        '办事处名称',
        12345678,
        'describe_name',
        '123456sdsd',
        2,
        123456,
        24.56,
        2021022409,
        1.23,
        2.34,
        11.34,
        2021022409,
        'dec_franchisee_code',
        'dec_franchisee_name'
)
`, tableN, n, n))

	for r := 1; r < rowCount; r++ {
		n = rand.Int63()
		buf.WriteString(fmt.Sprintf(", (\n%d, \n1,\n'collect_no_abcdefghijk1234567890',\n12345678,\n'collect_no_abcdefghijk12345',\n'operation_network_name_12345678901234567890',\n12345678,\n'operation_financial_center_name_1234567890',\n'operation_financial_center_cd',\n12345678,\n'send_financial_center_name_1234567890',\n'send_financial_center_code',\n12345678,\n'send_network_code_12',\n'send_network_name_1234567890',\n12345678,\n'结算网点12345677',\n'dec_network_name10000',\n12345678,\n'start_financial_center_code',\n'start_financial_center_name',\n'waybill_no%d',\n'2019-03-05 01:53:56',\n12345678,\n'sm_mode_name_12345678901234567890',\n'sm_mode_code_134567890',\n12345678,\n'货品名a货品g货品名a货品g货品名a货品g',\n'product_type_code12345',\n12345678,\n'转运名转动名xxxxabcdefefe',\n'transport_type_code',\n12345678,\n'商品名商品名商品名商品名',\n'xxxxxxwewf12345',\n12345678,\n'last_financial_center_name',\n'last_financial_center_code',\n12345678,\n'last_network_code',\n'last_network_name',\n'2019-03-05 01:53:56',\n12345678,\n'next_financial_center_name',\n'next_financial_center_code',\n12345678,\n'next_network_code',\n'next_network_name',\n'2019-03-05 01:53:56',\n12345678,\n'begin_name',\n'begin_code',\n12345678,\n'destination_name',\n'destination_code',\n12345678,\n'bill_update_by_name',\n'2019-03-05 01:53:56',\n'2019-03-05 01:53:56',\n'2019-03-05 01:53:56',\n1,\n123456,\n1.34,\n12345678,\n'fee_type_name',\n'fee_type_code',\n45.45,\n22.22,\n34.56,\n1, \n1,\n1,\n'1234567890123456',\n12345678,\n'confirmeder_network_code',\n'confirmeder_network_name',\n12345678,\n'confirmeder_name',\n'2019-03-05 01:53:56',\n2,\n12345678,\n'verifier_name12345678',\n'2019-03-05 01:53:56',\n1,\n'2019-03-05 01:53:56',\n1,\n1,\n1,\n1,\n'2019-03-05 01:53:56',\n2,\n1,\n'remarks1234567890',\n2,\n2,\n12345678,\n12345678,\n'create_by_name创建者',\n'update_by_name更新者',\n'2019-03-05 01:53:56',\n'2019-03-05 01:53:56',\n123,\n0,\n'1234567890',\n12345678,\n'四川省',\n12345678,\n'四川省',\n'2019-03-05 01:53:56',\n34.56,\n'customer_codeaaaaa',\n12345678,\n'四川省移动网络管理办',\n12345678,\n'describe_name',\n'123456sdsd',\n2,\n123456,\n24.56,\n2021022409,\n1.23,\n2.34,\n11.34,\n2021022409,\n'dec_franchisee_code',\n'dec_franchisee_name'\n)", n, n))
	}
	return buf.String()
}
